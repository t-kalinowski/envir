<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Source R files in an attached environment — attach_source • envir</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Source R files in an attached environment — attach_source" />
<meta property="og:description" content="Source R files in an attached environment" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">envir</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/t-kalinowski/envir/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Source R files in an attached environment</h1>
    <small class="dont-index">Source: <a href='https://github.com/t-kalinowski/envir/blob/master/R/attach_source.R'><code>R/attach_source.R</code></a></small>
    <div class="hidden name"><code>attach_source.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Source R files in an attached environment</p>
    </div>

    <pre class="usage"><span class='fu'>attach_source</span><span class='op'>(</span>
  <span class='va'>...</span>,
  name <span class='op'>=</span> <span class='fu'>as_tidy_env_name</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>, prefix <span class='op'>=</span> <span class='st'>"source:"</span><span class='op'>)</span>,
  recursive <span class='op'>=</span> <span class='cn'>FALSE</span>,
  pos <span class='op'>=</span> <span class='fl'>2L</span>,
  chdir <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warn.conflicts <span class='op'>=</span> <span class='cn'>TRUE</span>,
  mask.ok <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>filepaths to R files, or paths to directories containing R files.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>A string, the name for the attached environment. By default, the
name is constructed from paths supplied to <code>...</code>. If the requested name is
not on the search path, a new environment of this name is attached.</p></td>
    </tr>
    <tr>
      <th>recursive</th>
      <td><p>If directories are passed to <code>...</code>, whether to search them
recursively.</p></td>
    </tr>
    <tr>
      <th>pos</th>
      <td><p>The position where to attach the environment, if creating a new
one. If an environment of <code>name</code> already exists, <code>pos</code> is ignored.</p></td>
    </tr>
    <tr>
      <th>chdir</th>
      <td><p>logical. if TRUE, the <span style="R">R</span> working directory is temporarily
changed to the directory containing the file(s) being sourced.</p></td>
    </tr>
    <tr>
      <th>warn.conflicts</th>
      <td><p>logical. If TRUE (the default), print warnings about
objects in the attached environment that that are masking or masked by
other objects of the same name.</p></td>
    </tr>
    <tr>
      <th>mask.ok</th>
      <td><p>character vector of names of objects that can mask objects on
the search path without signaling a warning if <code>warn.conflicts</code> is <code>TRUE</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>the attached environment, invisibly.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>One subtlety that is sometimes important: the global environment or any
packages attached after this environment is created will be not on the search
path for the environment where the source is evaluated. The search path of
the environment the R files are sourced in is <code><a href='https://rdrr.io/r/utils/head.html'>tail(search(), -pos)</a></code>.</p>
<p>This means that, for example, if you source a script that calls
<code><a href='https://rdrr.io/r/base/library.html'>library()</a></code>, the code in that script will not "see" the functions from the
newly attached packages. This is by design. However, if you want to source
scripts that call <code>library</code> and define new functions, and you want those
new functions to "see" the <code>library</code> attached packages, here are 3 ways to
do that:</p><ol>
<li><p>Attach all the packages you want before attaching the script:</p></li>
</ol><p><div class="r"></p><pre><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>foo</span><span class='op'>)</span>; <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>bar</span><span class='op'>)</span>
<span class='fu'>attach_source</span><span class='op'>(</span><span class='st'>"my_script.R"</span><span class='op'>)</span>
</pre><p></div></p><ol>
<li><p>Modify the default <code>pos</code> argument to <code>library</code>, so all new packages
attach after your script:</p></li>
</ol><p><div class="r"></p><pre><span class='fu'>envir</span><span class='fu'>:::</span><span class='fu'>set_default_library_pos</span><span class='op'>(</span>after <span class='op'>=</span> <span class='st'>"source:my_script.R"</span><span class='op'>)</span>
<span class='fu'>attach_source</span><span class='op'>(</span><span class='st'>"my_script.R"</span><span class='op'>)</span>
</pre><p></div></p><ol>
<li><p>This is the likely the most preferred solution. Instead of sourcing
files directly in the attached environment, source the files into a new
environment that inherits from <code>.Globalenv</code>, and then copy over everything
to the attached environment.</p></li>
</ol><p><div class="r"></p><pre><span class='fu'><a href='attach_eval.html'>attach_eval</a></span><span class='op'>(</span><span class='op'>{</span>
  <span class='fu'><a href='import_from.html'>import_from</a></span><span class='op'>(</span><span class='st'>"my_script.R"</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</pre><p></div></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='import_from.html'>import_from</a>, <a href='set_library_default_pos.html'>set_library_default_pos</a></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tomasz Kalinowski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


